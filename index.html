<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>STREAM Bulk Docs</title>
  <meta name="description" content="Documentation for STREAM Bulk.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --font-display: "Space Grotesk", "IBM Plex Sans", sans-serif;
      --font-body: "IBM Plex Sans", "Helvetica Neue", Helvetica, sans-serif;
      --bg: #f4f6f9;
      --bg-2: #eff3f8;
      --text: #0b1b2b;
      --muted: #55667a;
      --accent: #0f766e;
      --accent-2: #0a4944;
      --accent-3: #f59e0b;
      --card: #ffffff;
      --line: #d7e0ea;
      --shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
      --radius-lg: 22px;
      --radius-md: 14px;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      font-family: var(--font-body);
      color: var(--text);
      background:
        radial-gradient(circle at 12% 10%, rgba(94, 234, 212, 0.28), transparent 45%),
        radial-gradient(circle at 88% 15%, rgba(245, 158, 11, 0.18), transparent 45%),
        linear-gradient(120deg, var(--bg), var(--bg-2));
      background-attachment: fixed;
      position: relative;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(120deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0)),
        repeating-linear-gradient(
          120deg,
          rgba(15, 23, 42, 0.03) 0px,
          rgba(15, 23, 42, 0.03) 1px,
          transparent 1px,
          transparent 6px
        );
      pointer-events: none;
      z-index: 0;
    }

    .bg-orb {
      position: absolute;
      border-radius: 999px;
      filter: blur(0px);
      opacity: 0.6;
      z-index: 0;
    }

    .orb-1 {
      width: 260px;
      height: 260px;
      background: radial-gradient(circle, rgba(94, 234, 212, 0.6), rgba(94, 234, 212, 0));
      top: 80px;
      left: -40px;
    }

    .orb-2 {
      width: 360px;
      height: 360px;
      background: radial-gradient(circle, rgba(15, 118, 110, 0.45), rgba(15, 118, 110, 0));
      top: 20px;
      right: -120px;
    }

    .orb-3 {
      width: 280px;
      height: 280px;
      background: radial-gradient(circle, rgba(245, 158, 11, 0.35), rgba(245, 158, 11, 0));
      bottom: 80px;
      left: 30%;
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    .site-header {
      position: relative;
      z-index: 2;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.5rem;
      padding: 1.5rem clamp(16px, 3vw, 40px) 0;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.9rem;
    }

    .brand-mark {
      width: 46px;
      height: 46px;
      border-radius: 14px;
      background:
        linear-gradient(145deg, rgba(15, 118, 110, 0.95), rgba(94, 234, 212, 0.9));
      box-shadow: 0 12px 30px rgba(15, 118, 110, 0.25);
      display: grid;
      place-items: center;
      font-weight: 700;
      color: #fff;
      font-size: 1.05rem;
      letter-spacing: 0.04em;
    }

    .brand-text h1 {
      font-family: var(--font-display);
      margin: 0;
      font-size: clamp(1.4rem, 2.6vw, 2.1rem);
      letter-spacing: 0.01em;
    }

    .brand-text p {
      margin: 0.2rem 0 0;
      color: var(--muted);
      font-size: 0.95rem;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.65rem 1.1rem;
      border-radius: 999px;
      border: 1px solid transparent;
      font-weight: 600;
      font-size: 0.92rem;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    }

    .btn.primary {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 12px 24px rgba(15, 118, 110, 0.22);
    }

    .btn.primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 30px rgba(15, 118, 110, 0.28);
    }

    .btn.ghost {
      background: rgba(255, 255, 255, 0.7);
      color: var(--accent-2);
      border-color: rgba(15, 118, 110, 0.2);
    }

    .btn.ghost:hover {
      background: #fff;
    }

    .nav-toggle {
      display: none;
      background: #fff;
      border: 1px solid var(--line);
      border-radius: 999px;
      padding: 0.55rem 0.95rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 8px 18px rgba(15, 23, 42, 0.08);
    }

    .layout {
      position: relative;
      z-index: 1;
      display: grid;
      grid-template-columns: minmax(220px, 290px) minmax(0, 1fr);
      gap: clamp(1.2rem, 3vw, 2.6rem);
      padding: clamp(1.4rem, 3vw, 2.5rem) clamp(16px, 3vw, 40px) 4rem;
      align-items: start;
    }

    .side-nav {
      background: rgba(255, 255, 255, 0.85);
      border: 1px solid var(--line);
      border-radius: var(--radius-lg);
      padding: 1.2rem;
      box-shadow: var(--shadow);
      position: sticky;
      top: 1.5rem;
      backdrop-filter: blur(14px);
      transition: transform 0.3s ease;
    }

    .side-nav__header {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      margin-bottom: 1rem;
    }

    .side-nav__header span {
      text-transform: uppercase;
      letter-spacing: 0.18em;
      font-size: 0.68rem;
      color: var(--muted);
      font-weight: 600;
    }

    .side-nav__header h2 {
      margin: 0;
      font-family: var(--font-display);
      font-size: 1.2rem;
    }

    .nav-list {
      display: flex;
      flex-direction: column;
      gap: 0.65rem;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
      padding: 0.75rem 0.9rem;
      border-radius: 12px;
      border: 1px solid transparent;
      color: var(--text);
      background: transparent;
      transition: border 0.2s ease, transform 0.2s ease, background 0.2s ease;
    }

    .nav-item__title {
      font-weight: 600;
      font-size: 0.97rem;
    }

    .nav-item__desc {
      color: var(--muted);
      font-size: 0.82rem;
      line-height: 1.3;
    }

    .nav-item:hover {
      border-color: rgba(15, 118, 110, 0.25);
      background: rgba(94, 234, 212, 0.18);
      transform: translateX(2px);
      text-decoration: none;
    }

    .nav-item.active {
      border-color: rgba(15, 118, 110, 0.45);
      background: rgba(15, 118, 110, 0.12);
      box-shadow: 0 12px 20px rgba(15, 118, 110, 0.15);
    }

    .content {
      display: flex;
      flex-direction: column;
      gap: 1.8rem;
    }

    .hero {
      background: var(--card);
      border-radius: var(--radius-lg);
      padding: clamp(1.5rem, 3vw, 2.4rem);
      box-shadow: var(--shadow);
      border: 1px solid var(--line);
      display: grid;
      gap: 1.4rem;
      overflow: hidden;
      position: relative;
    }

    .hero::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg, rgba(15, 118, 110, 0.08), transparent 45%);
      pointer-events: none;
    }

    .hero h2 {
      font-family: var(--font-display);
      font-size: clamp(1.6rem, 2.6vw, 2.4rem);
      margin: 0;
    }

    .hero p {
      margin: 0;
      color: var(--muted);
      font-size: 1rem;
      max-width: 56ch;
    }

    .hero-actions {
      display: flex;
      gap: 0.8rem;
      flex-wrap: wrap;
    }

    .hero-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 0.9rem;
      margin-top: 0.3rem;
    }

    .hero-card {
      padding: 1rem;
      border-radius: var(--radius-md);
      border: 1px solid var(--line);
      background: rgba(239, 243, 248, 0.9);
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      min-height: 120px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .hero-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 24px rgba(15, 23, 42, 0.12);
    }

    .hero-card span {
      font-weight: 600;
    }

    .hero-card small {
      color: var(--muted);
      font-size: 0.85rem;
      line-height: 1.4;
    }

    .doc-shell {
      background: var(--card);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      border: 1px solid var(--line);
      padding: clamp(1.4rem, 2.4vw, 2.2rem);
      animation: fadeUp 0.4s ease;
    }

    .doc-meta {
      display: flex;
      flex-wrap: wrap;
      align-items: baseline;
      gap: 0.8rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--line);
      margin-bottom: 1.5rem;
    }

    .doc-meta h3 {
      margin: 0;
      font-family: var(--font-display);
      font-size: clamp(1.2rem, 2vw, 1.6rem);
    }

    .doc-meta span {
      font-size: 0.85rem;
      color: var(--muted);
      background: rgba(15, 118, 110, 0.12);
      padding: 0.3rem 0.6rem;
      border-radius: 999px;
    }

    .doc-content {
      font-size: 1rem;
      line-height: 1.7;
    }

    .doc-content h1,
    .doc-content h2,
    .doc-content h3,
    .doc-content h4 {
      font-family: var(--font-display);
      margin-top: 1.8rem;
      margin-bottom: 0.6rem;
    }

    .doc-content h1 {
      font-size: 2rem;
    }

    .doc-content h2 {
      font-size: 1.5rem;
    }

    .doc-content h3 {
      font-size: 1.2rem;
    }

    .doc-content p {
      margin: 0.6rem 0 1rem;
    }

    .doc-content ul,
    .doc-content ol {
      padding-left: 1.4rem;
      margin: 0 0 1rem;
    }

    .doc-content li {
      margin-bottom: 0.4rem;
    }

    .doc-content code {
      font-family: "SFMono-Regular", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.92rem;
      background: rgba(15, 23, 42, 0.05);
      padding: 0.15rem 0.35rem;
      border-radius: 6px;
    }

    .doc-content pre {
      background: #f3f4f6;
      color: var(--text);
      padding: 1rem;
      border-radius: 12px;
      border: 1px solid var(--line);
      overflow: auto;
      margin: 1.2rem 0;
    }

    .doc-content pre code {
      background: transparent;
      padding: 0;
      color: inherit;
    }

    .doc-content blockquote {
      border-left: 3px solid var(--accent);
      padding-left: 1rem;
      color: var(--muted);
      margin: 1rem 0;
    }

    .doc-content table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.2rem 0;
      font-size: 0.95rem;
    }

    .doc-content th,
    .doc-content td {
      text-align: left;
      padding: 0.7rem;
      border-bottom: 1px solid var(--line);
    }

    .doc-content img {
      max-width: 100%;
      border-radius: 12px;
      box-shadow: 0 12px 20px rgba(15, 23, 42, 0.12);
    }

    .doc-loading,
    .doc-error {
      padding: 1rem;
      border-radius: 12px;
      background: rgba(245, 158, 11, 0.16);
      border: 1px solid rgba(245, 158, 11, 0.4);
      font-weight: 600;
    }

    .doc-error {
      background: rgba(220, 38, 38, 0.12);
      border-color: rgba(220, 38, 38, 0.45);
    }

    .footer {
      text-align: center;
      color: var(--muted);
      padding: 2rem 1rem 3rem;
      font-size: 0.9rem;
      position: relative;
      z-index: 1;
    }

    .nav-scrim {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.4);
      backdrop-filter: blur(2px);
      z-index: 3;
    }

    .nav-scrim[hidden] {
      display: none;
    }

    @media (max-width: 960px) {
      .layout {
        grid-template-columns: 1fr;
      }

      .side-nav {
        position: fixed;
        inset: 100px auto auto 16px;
        width: min(86vw, 320px);
        max-height: calc(100vh - 140px);
        overflow: auto;
        transform: translateX(-120%);
        z-index: 4;
      }

      .side-nav[data-open="true"] {
        transform: translateX(0);
      }

      .nav-toggle {
        display: inline-flex;
      }
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(8px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>
<body>
  <div class="bg-orb orb-1"></div>
  <div class="bg-orb orb-2"></div>
  <div class="bg-orb orb-3"></div>
  <div id="nav-scrim" class="nav-scrim" hidden></div>

  <header class="site-header">
    <div class="brand">
      <div class="brand-mark">SB</div>
      <div class="brand-text">
        <h1>STREAM Bulk Docs</h1>
        <p>Bulk RNA-seq workflows, dashboards, and reference material.</p>
      </div>
    </div>
    <div class="header-actions">
      <button class="nav-toggle" id="nav-toggle" aria-controls="side-nav" aria-expanded="false">Menu</button>
      <a class="btn ghost" href="#/readme">README</a>
      <a class="btn primary" href="#/getting-started">Start here</a>
    </div>
  </header>

  <div class="layout">
    <aside class="side-nav" id="side-nav" data-open="false">
      <div class="side-nav__header">
        <span>Docs</span>
        <h2>Contents</h2>
      </div>
      <nav class="nav-list" id="nav-list" aria-label="Documentation"></nav>
    </aside>

    <main class="content">
      <section class="hero">
        <h2>Everything you need to run STREAM Bulk with confidence.</h2>
        <p>Browse the quickstart, workflows, CLI reference, and configuration notes. This site is powered directly by the Markdown docs in the repository.</p>
        <div class="hero-actions">
          <a class="btn primary" href="#/getting-started">Quickstart</a>
          <a class="btn ghost" href="#/api-reference">API reference</a>
        </div>
        <div class="hero-cards" id="hero-cards"></div>
      </section>

      <section class="doc-shell">
        <div class="doc-meta">
          <h3 id="doc-title">Loading docs</h3>
          <span id="doc-path"></span>
        </div>
        <article id="doc-content" class="doc-content"></article>
      </section>
    </main>
  </div>

  <footer class="footer">
    STREAM Bulk documentation site for GitHub Pages. Built from `docs/` and top-level Markdown files.
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    const docsIndexPath = "docs/index.md";
    const navList = document.getElementById("nav-list");
    const heroCards = document.getElementById("hero-cards");
    const docContent = document.getElementById("doc-content");
    const docTitle = document.getElementById("doc-title");
    const docPath = document.getElementById("doc-path");
    const navToggle = document.getElementById("nav-toggle");
    const navScrim = document.getElementById("nav-scrim");
    const sideNav = document.getElementById("side-nav");

    const fallbackItems = [
      { path: "README.md", label: "README", description: "End-user overview and quickstart." },
      { path: "docs/getting-started.md", label: "Getting Started", description: "Installation and first successful run." },
      { path: "docs/user-guide.md", label: "User Guide", description: "Workflows and examples." },
      { path: "docs/api-reference.md", label: "API Reference", description: "Public API surface." },
      { path: "docs/cli.md", label: "CLI", description: "CLI usage." },
      { path: "docs/configuration.md", label: "Configuration", description: "Environment variables and defaults." },
      { path: "docs/file-formats.md", label: "File Formats", description: "Input and output file formats." },
      { path: "docs/developer-guide.md", label: "Developer Guide", description: "Repo layout and contribution notes." },
      { path: "docs/testing.md", label: "Testing", description: "How to run tests." },
      { path: "CONTRIBUTING.md", label: "CONTRIBUTING", description: "Contribution guidelines." },
      { path: "CHANGELOG.md", label: "CHANGELOG", description: "Release notes." }
    ];

    let routes = [];
    let routeMap = {};
    let defaultRouteId = "";

    if (window.marked) {
      marked.setOptions({ mangle: false, headerIds: false });
    }

    function slugify(value) {
      return value
        .toLowerCase()
        .replace(/\.md$/, "")
        .replace(/[^a-z0-9]+/g, "-")
        .replace(/^-+|-+$/g, "");
    }

    function titleize(value) {
      return value
        .split("-")
        .map(part => part.charAt(0).toUpperCase() + part.slice(1))
        .join(" ");
    }

    function labelFromPath(path) {
      const file = path.split("/").pop().replace(/\.md$/, "");
      const upper = file.toUpperCase();
      if (upper === "README" || upper === "CHANGELOG" || upper === "CONTRIBUTING") {
        return upper;
      }
      return titleize(file);
    }

    function parseDocsIndex(markdown) {
      const items = [];
      markdown.split("\n").forEach(line => {
        const match = line.trim().match(/^-\\s+`([^`]+)`\\s*:\\s*(.+)$/);
        if (!match) {
          return;
        }
        items.push({
          path: match[1].trim(),
          label: labelFromPath(match[1].trim()),
          description: match[2].trim()
        });
      });
      return items;
    }

    function buildRoutes(items) {
      const used = new Set();
      return items.map(item => {
        const base = item.path.split("/").pop().replace(/\.md$/, "");
        let id = slugify(base);
        if (!id || used.has(id)) {
          id = slugify(item.path.replace(/\//g, "-"));
        }
        used.add(id);
        return { ...item, id };
      });
    }

    function setNavOpen(open) {
      sideNav.dataset.open = open ? "true" : "false";
      navScrim.hidden = !open;
      navToggle.setAttribute("aria-expanded", open ? "true" : "false");
      document.body.classList.toggle("nav-open", open);
    }

    function renderNav(items) {
      navList.innerHTML = "";
      items.forEach(item => {
        const link = document.createElement("a");
        link.className = "nav-item";
        link.href = "#/" + item.id;
        link.dataset.route = item.id;
        link.innerHTML = "<span class=\"nav-item__title\">" + item.label + "</span>" +
          "<span class=\"nav-item__desc\">" + (item.description || "") + "</span>";
        navList.appendChild(link);
      });
    }

    function renderHero(items) {
      const picks = ["getting-started", "user-guide", "api-reference"]
        .map(id => items.find(item => item.id === id))
        .filter(Boolean);
      const cards = picks.length ? picks : items.slice(0, 3);
      heroCards.innerHTML = "";
      cards.forEach(item => {
        const card = document.createElement("a");
        card.href = "#/" + item.id;
        card.className = "hero-card";
        card.innerHTML = "<span>" + item.label + "</span>" +
          "<small>" + (item.description || "Open documentation") + "</small>";
        heroCards.appendChild(card);
      });
    }

    function setActiveNav(routeId) {
      navList.querySelectorAll(".nav-item").forEach(link => {
        const isActive = link.dataset.route === routeId;
        link.classList.toggle("active", isActive);
        link.setAttribute("aria-current", isActive ? "page" : "false");
      });
    }

    function updateMeta(item) {
      docTitle.textContent = item.label;
      docPath.textContent = item.path;
      document.title = "STREAM Bulk Docs - " + item.label;
    }

    async function fetchMarkdown(path) {
      const response = await fetch(path, { cache: "no-store" });
      if (!response.ok) {
        throw new Error("Failed to load " + path + ": " + response.status);
      }
      return response.text();
    }

    function renderMarkdown(markdown) {
      if (!window.marked) {
        docContent.innerHTML = "<div class=\"doc-error\">Markdown renderer failed to load.</div>";
        return;
      }
      docContent.innerHTML = marked.parse(markdown);
    }

    async function loadRoute(routeId) {
      const item = routeMap[routeId];
      if (!item) {
        docContent.innerHTML = "<div class=\"doc-error\">Unknown route. Check the navigation.</div>";
        return;
      }
      setActiveNav(routeId);
      updateMeta(item);
      docContent.innerHTML = "<div class=\"doc-loading\">Loading content...</div>";
      try {
        const markdown = await fetchMarkdown(item.path);
        renderMarkdown(markdown);
      } catch (error) {
        docContent.innerHTML = "<div class=\"doc-error\">Could not load " + item.path +
          ". Serve the repo via a local server or GitHub Pages.</div>";
      }
    }

    function getRouteId() {
      const hash = window.location.hash || "";
      if (hash.startsWith("#/")) {
        return hash.slice(2);
      }
      return defaultRouteId;
    }

    function handleHashChange() {
      if (!window.location.hash) {
        window.location.hash = "#/" + defaultRouteId;
        return;
      }
      if (!window.location.hash.startsWith("#/")) {
        return;
      }
      loadRoute(getRouteId());
      if (window.innerWidth <= 960) {
        setNavOpen(false);
      }
    }

    async function init() {
      let items = [];
      try {
        const indexMarkdown = await fetchMarkdown(docsIndexPath);
        items = parseDocsIndex(indexMarkdown);
      } catch (error) {
        items = [];
      }
      if (!items.length) {
        items = fallbackItems;
      }
      routes = buildRoutes(items);
      routeMap = routes.reduce((acc, item) => {
        acc[item.id] = item;
        return acc;
      }, {});
      defaultRouteId = routes[0] ? routes[0].id : "readme";
      renderNav(routes);
      renderHero(routes);
      if (!window.location.hash) {
        window.location.hash = "#/" + defaultRouteId;
      }
      handleHashChange();
    }

    navToggle.addEventListener("click", () => {
      setNavOpen(sideNav.dataset.open !== "true");
    });

    navScrim.addEventListener("click", () => {
      setNavOpen(false);
    });

    document.addEventListener("keydown", event => {
      if (event.key === "Escape") {
        setNavOpen(false);
      }
    });

    navList.addEventListener("click", event => {
      const link = event.target.closest("a");
      if (!link) {
        return;
      }
      if (window.innerWidth <= 960) {
        setNavOpen(false);
      }
    });

    docContent.addEventListener("click", event => {
      const link = event.target.closest("a");
      if (!link) {
        return;
      }
      const href = link.getAttribute("href");
      if (!href || href.startsWith("http") || href.startsWith("mailto:")) {
        return;
      }
      const normalized = href.startsWith("./") ? href.slice(2) : href;
      const match = routes.find(item => item.path === normalized || item.path === href);
      if (match) {
        event.preventDefault();
        window.location.hash = "#/" + match.id;
      }
    });

    window.addEventListener("hashchange", handleHashChange);
    window.addEventListener("resize", () => {
      if (window.innerWidth > 960) {
        setNavOpen(false);
      }
    });

    init();
  </script>
</body>
</html>
